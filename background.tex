\chapter{Background and Related Work} \label{chap:background}
Providing a complete history of map and globe making (cartography) is much beyond both the scope and ability of this thesis.
Instead, we provide a brief background to illuminate how these disciplines influenced the developments of Digital Earth systems.
We discuss the different approaches for a Digital Earth, starting with traditional GIS, and then discuss techniques used for globe based systems and analysis.
We also provide background and related work on discrete global grids and grid systems, looking at different methods for constructing both 2D and 3D versions of these data structures.


\section{Traditional Maps and Globes}
Cartography, the study and practice of making maps, is a mature and diverse discipline.
While there is no agreement on the earliest known map, there exist samples dating to the 4th millennium BCE and surviving world maps from 9th century BCE Babylonia.
While one may think of maps primarily as a navigation tool, the uses extend much further.
Maps allow geospatial data (data with an associated geographic component) to be encoded, processed, and visualized in a scale reference.
Therefore, any field or discipline using such data often also uses maps of said data.


In the 3rd century BCE, the ancient Greeks established that the Earth is spherical; with this came the first globes of Earth.
Globes serve a similar purpose as maps; however, the use of a spherical reference as opposed to a planar one provides a more accurate representation of the Earth.
Despite this, maps were---and continue to be---the primary medium for representing the Earth and geospatial data~\cite{hruby20182000}.
Compared to maps, globes are more expensive to manufacture and more difficult to store, transport, and make measurements on.
Maps can also represent the entire Earth in one view and easily accommodate any scale.


\subsection{Map Projections}
The above benefits of a flat map over a globe do not come without their disadvantages
Producing a map requires flattening the spherical Earth to a flat plane---an operation known as map projection (or simply projection)---which introduces inevitable distortions and map edges.
These issues are not present on globes, and because of this, they provide a more accurate representation of the Earth than is possible with any map.
Despite these fundamental challenges, the many benefits of maps have motivated the use and study of these operations~\cite{snyder1987map, snyder1997flattening}.


Distortions in a map projection (or more generally in any mapping) are measured by their effect on angles, areas, and distances.
While eliminating all distortion is impossible, specialized projection methods exist that remove certain types of distortion.
Commonly used conformal [] and area-preserving [] projections preserve angles and areas, respectively.
Preserving distance also removes all other distortion, and since the sphere in non-developable, isometric projections between the sphere and the plane are impossible.
However, projections that preserve only certain distances, such as all those to a certain point, are achievable. []
Alternatively, some methods aim for a balanced trade-off between the different types of distortion, as opposed to eliminating a specific type. []
\cite{mathematics paper on distortion}
\cite{planar area preserving}
\cite{planar conformal}


Since distortion cannot be completely removed, measurements and analyses done on flat maps can produce errors.
Straight lines may not map to the actual shortest path, area distortions may misrepresent the density of phenomena, and locations may appear much closer together or farther apart than they genuinely are.
The amount and type of errors depend both on the projections used and the type of analysis performed, with certain maps being better suited for certain operations.
For example, the Mercator projection maps straight lines to rhumb lines making it a popular choice for navigation; however, the severely distorted area makes this projection a poor choice for representing the frequency of phenomena in different regions.
It is, therefore, essential to use an appropriate map projection for each intended use case, with no one projection being ideal in all circumstances.


Another significant challenge with flat maps is the edges (or boundaries) introduced.
Such edges can have a significant impact on a person's understanding of a map when phenomena cross these boundaries.
A study by Hennerdal asked participants to predict the location and direction of an airplane crossing the boundary of different map projections~\cite{hennerdal2015beyond}.
The study found that participants would often incorrectly place the airplane at the point of \textit{linear} peripheral continuity (the intersection of the straight line tangent to the initial aircraft location and the opposite map edge) as opposed to the correct location.
The occurrence of this mistake was most prominent with children; however, the effect was still present with adult participants. Another study by Hruby et al. measured how such edges impact the estimation of distance~\cite{hruby2016journey}.
Two groups of participants, given either a Eurocentric or Americentirc map to memorize locations, were asked to estimate the distances between various Asian and American cities.
While both groups overestimated distances on average, the group with the Eurocentric map (where the shortest distances crossed the map boundary), had larger estimation errors than the other group.
These studies further show that the projection used for a map must be chosen and centred carefully to ensure readers correctly understand how the map relates to the actual Earth.


\subsubsection{Polyhedral Projections}
At the cost of introducing additional map edges, cutting a map can reduce the amount of distortion introduced by projection~\cite{soliman2018optimal}.
Such cuts are analogous to projecting the sphere to an underlying polyhedron, the net of which produces the final flat map.
Aside from reducing distortion, this type of map can serve as a pseudo-globe by folding the net into the corresponding polyhedron.


As will be discussed later, this class of projection methods is also a core component of any polyhedron based discretization of the Earth.
Since equal-area cells are often desired for such discretizations, many area-preserving projections between the sphere and various polyhedron have been developed~\cite{bradley1946equal, snyder1992equal, van2006slice, rocsca2011uniform, rocsca2012area, holhocs2014octahedral}.
There has also been work to improve the efficiency of these projections for use with Digital Earth systems~\cite{harrison2011optimization}.


\section{Digital Earth Systems}
With the advent of computing systems came the move of maps from the physical domain to the digital one.
Initially, this required scanning existing physical maps to digitize the data they contained.
As the prevalence of computers increased, more geospatial data was stored natively in digital formats.
Nowadays, nearly all (if not all) geospatial data is collected and stored digitally.
Furthermore, advancements in remote sensing technologies, smart technologies, and the Internet of things have lead to explosive increases in the amount of geospatial data collected.
Modern computers can process vast amounts of data compared to what is possible manually; despite this, the volume and complexity of geospatial data available and being collected surpasses even this capacity~\cite{lee2015geospatial}.


To make full use of the geospatial data gathered by society, former US vice president Al Gore proposed the idea of a Digital Earth~\cite{gore1998}.
This Digital Earth---a 3D virtual globe---would serve as a common reference for the vast majority of geospatial data to be freely accessible by the public.
This vision has since been further refined to be not one, but several connected Digital Earths that individually better meet the needs of specific audiences~\cite{goodchild2012next}.
Currently, many different systems exist for creating a Digital Earth with significant variations in methodology, scope, and intended use(s).



\subsection{Geographic Information Systems}
Long before Al Gore's idea of a Digital Earth, traditional cartography techniques were being applied to systems for creating and managing digital maps.
These technologies became what is known today as GIS~\cite{foresman1998history}.
Just as with physical maps, in a GIS, different datasets are represented as individual layers in a planar coordinate system.
Different layers can then be integrated and analyzed through combinations of set operations (union, intersection, and difference), statistical analysis (such as mean and standard deviation), and other operations.
These integrations and analyses are also used to create visualizations of the underlying data.


Since their introduction, GIS has proven to be a powerful framework for managing geospatial data.
This power, however, is a double-edged sword; proper use of a GIS requires a significant amount of knowledge and expertise~\cite{antenucci1991geographic}.
To be used with a GIS, geospatial data must first be cleaned, processed, integrated, and distributed.
All of these operations require familiarity with both the system used and the underlying cartographic principles.
Furthermore, due to the use of a planar coordinate system, distortion from projection can introduce errors in analysis and visualization, just as with physical maps.
Which map projection to use for which use cases must be considered carefully, which also requires sufficient domain expertise.


\subsection{Globe Based Digital Earth}
A more recent approach to a Digital Earth---and one more in line with Al Gore's initial proposal---is a globe based Digital Earth.
While physical globes have practical drawbacks in comparison to a map, in a digital setting, these drawbacks are reduced if not completely negated. 
Modern computer graphics algorithms and hardware have made creating, storing, and displaying a virtual globe in real-time no more difficult than displaying the equivalent map.
Interactive systems allow zooming on a globe to show any region of the Earth at the desired scale, and also for digital measurements.
Virtual globes still cannot display the entire Earth at once; however, novel interaction techniques such as multi-view focus plus context rendering can help alleviate this limitation~\cite{mark-sherlock}.


Due to the reduced distortion with a globe, there has been a push toward globe based Digital Earth systems as opposed to conventional map based ones~\cite{goodchild2018reimagining}.
One approach for doing so is to still use a flat map as the underlying representation of the Earth and then map back to a globe for visualization.
While this solves the issues of map edges and distortion for visual analysis purposes, it does not address the distortion present for any analysis using the flat map and the corresponding errors introduced.
The alternative is to do analysis directly in spherical---or even more accurately, ellipsoidal---space.
While ellipsoidal analysis is often prohibitively complicated and expensive due to the mathematical challenges of elliptic integrals [], techniques for spherical analysis are well understood~\cite{raskin1994spatial}.
While spherical analyses are still significantly more involved than the planar equivalents, modern computational capabilities are making them more feasible. 
In addition to standard methods, there have been several recent works on techniques for more complicated spherical analysis and operations.
Some examples include better representations for rational points on the sphere~\cite{bahrdt2017rational}, multiresolution representations of B-spline~\cite{alderson2016multiresolution} and NURBS curves~\cite{alderson2019multiscale}, and methods for offsetting both vector and raster curves~\cite{alderson2018offsetting}.
For these reasons, direct spherical analysis on a globe based Digital Earth is becoming a compelling alternative to traditional GIS. For a detailed analysis of different Digital Earth systems, refer to~\cite{mahdavi2015survey} and~\cite{alderson2020digital}.


\section{Discrete Global Grids}
Space partitioning data structures have long been used in computer graphics to aid various geometry querries.
These data structures provide information about which objects are near others and prevent unnecessary queries and tests between distant geometries.
Common examples of this type of data structure include voxel grids, k-d trees, binary spatial partitioning (BSP) trees, and quad/octrees.
Space partitionings, particularly compact and uniform ones, are also useful for the sampling and aggregation of data. 


Similarly, space partitionings of the Earth for geospatial data are also useful.
However, due to the spherical nature of the Earth, different techniques are often used as opposed to the above methods designed for Euclidean spaces.
A DGG partitions the surface of the Earth into a set of non-overlapping cells allowing geospatial data to be associated with the appropriate cell(s).
There exist several different approaches for creating a DGG, each with benefits and drawbacks.
Likewise, the specific uses of a DGG vary based on the Digital Earth system.
In some systems, a DGG only serves as a data structure for speeding up various spatial queries and analyses.
Other entities have used a DGG (more specifically, a DGGS---described in more detail below) as the foundation and framework for an entire Digital Earth system~\cite{peterson2011close}.
Regardless of their specific use(s), DGG's are an essential aspect of many Digital Earths and, as such, are well studied.


\subsection{Discrete Global Grid Systems}
While DGG's are a helpful tool, they only represent the Earth at one spatial resolution.
If only working with one dataset, this is adequate; however, geospatial data comes in a wide range of resolutions, so when working with multiple datasets, multiple resolutions of DGG's may be needed.
This shortcoming is addressed with a hierarchy of DGG's at increasingly fine resolutions, also known as a DGGS~\cite{sahr1998discrete, sahr2003geodesic}.
Such a hierarchy allows geospatial data at any spatial resolution to be appropriately integrated at its native resolution and used with any other dataset.


\subsubsection{Refinement}
The most common approach for creating a DGGS is by defining an initial discretization and cell refinement method.
The initial discretization is a DGG that serves as the most coarse level of the hierarchy. The cell refinement method defines a process for creating the next level of the hierarchy from the previous.
If done systematically and consistently, refinement can be applied successively to create arbitrarily fine discretizations of the Earth.


Different refinement schemes are classified by their input cell shape(s), which are given by the initial discretization; output cell shape(s), which are usually the same as the input; and their refinement factor, which is simply the ratio between the number of coarse and fine cells.
For example, triangle 1-to-4 (1:4) refinement produces four fine triangle cells for each triangle in the set of coarse cells.
The refinement factor determines how quickly the resolution of the grid increases with each application of the refinement method, with lower ones usually preferred in order to represent the Earth at a higher number of resolutions.


Refinement should also maintain the relative shape of cells between different resolutions in the context of a DGGS.
For example, square cells should not be made increasingly rectangular during refinement.
This property ensures that refinement maintains the compactness and aspect ratio of cells between different resolutions of the grid system.
Two other noteworthy properties of refinement are congruency and alignment.
With congruent refinement, each coarse cell is composed of a union of fine cells.
Aligned refinement requires that each coarse cell shares a certain point with a fine cell, usually either a vertex or centroid (for vertex-aligned and centre-aligned refinement, respectively).
Congruency and alignment are not required properties of refinement but are desirable in certain situations.
Furthermore, based on other requirements of the refinement method, these properties may be unattainable. For example, congruent refinement is impossible for hexagon cells.


As an aside, in the literature, the term subdivision is used interchangeably with refinement.
While these terms are equivalent in the context of a DGGS, in the computer graphics literature, subdivision typically refers to subdivision curves and surfaces: processes that involve vertex repositioning.
For consistency and to avoid confusion, this thesis exclusively uses the term refinement to refer to the process of creating a set of fine cells from a set of coarse ones, even if vertex repositioning is a part of this operation.


\subsection{Spherical Grids}
With the Earth commonly approximated as a sphere, many DGG's and DGGS's are defined directly in this space.
One of the most straightforward approaches for doing so is with a regular discretization based on latitude and longitude coordinates, or a latitude-longitude grid (LLG).
Similar to a regular grid in Euclidean space defined by equal steps in Cartesian coordinates, an LLG divides the sphere into equal steps of latitude and longitude.
Unlike Cartesian coordinates, however, spherical coordinates have singularities at both poles causing quadrilateral LLG cells to degenerate into triangle cells at the poles.
This degeneration reduces the compactness of cells near the poles, produces a high valence vertex at each of the poles, and results in cells in the grid having unbounded area differences.
Thus, an LLG is neither a compact nor uniform DGG.


One strategy to lessen the drawbacks of an LLG is to change the longitude step size as a function of latitude. As (absolute) latitude increases, the same angular longitude corresponds to decreasing arc lengths on the sphere.
Thus, decreasing the longitude step size in an LLG at higher latitudes results in more uniformly sized and compact grid cells at the cost of introducing an irregular connectivity structure to the grid.
Using this strategy, Leopardi provides a formulation for creating an equal area and compact partitioning of the sphere into any number of regions~\cite{leopardi2006partition}.
Similarly, the Degenerate Quadtree Grid (DQG) proposed by Sun et al. makes use of a modified quadtree refinement to create this type of grid~\cite{sun2008global}.
The use of a refinement method---along with the provided encoding, decoding, and indexing algorithms---allows the DQG to operate as a full DGGS as opposed to a just a single resolution DGG.


Another approach that solves some of the issues with a simple LLG is the Yin-Yang grid proposed by Kageyama and Sato~\cite{kageyama2004yin-yang}.
This grid is composed of two congruent component grids---the Yin and Yang grids---which are LLG's 270\textdegree \ in longitude and 90\textdegree \ in latitude centred at the equator
These component grids are then rotated and placed atop each other to cover the sphere fully.
As the component grids have a limited latitude, they do not have the same compactness and area issues seen in an LLG.
However, cells near the boundaries of the component grids overlap in the composite grid creating either ambiguity or redundancy when associating geospatial data with cells and complicating grid connectivity in these regions.


A different method for defining a grid in spherical space is to forgo latitude and longitude coordinates altogether, and instead use arbitrary curves to define the edges of the grid.
A method by Song et al. uses small circle arcs to perform an equal area triangle refinement~\cite{song2002developing}.
While the resulting cells are equal area and have good compactness properties, calculating the correct small circle arcs to use during refinement is non-trivial.
Furthermore, these types of grids have less straightforward and more expensive operations, often requiring a hierarchical algorithm (linear time on the level of refinement) as opposed to a direct (constant time) one.


\subsection{Polyhedral Grids}
As opposed to defining the grid directly in spherical space, a more recent and increasingly popular approach is to use a polyhedron as an initial approximation of the sphere.
The most common choices for these polyhedra are the Platonic solids, as they are perfectly regular; however, other choices are also possible.
Mapping back and forth between the Earth and polyhedron is accomplished using a polyhedral map projection and its inverse, respectively, and planar refinement of the faces of the polyhedron creates the cell hierarchy for a DGGS.
This style of grid avoids degeneracies in the grid at the poles, providing a more uniform discretization of the entire Earth compared to grids based on latitude and longitude coordinates.
Furthermore, the use of an area-preserving projection in conjunction with an area-preserving refinement of the polyhedron allows for an equal area grid without a significant reduction in cell compactness.


One of the earliest polyhedron based DGGS's is the Sphere Quadtree, proposed by Fekete in 1990~\cite{fekete1990sphere}.
This system uses a regular icosahedron as the initial discretization, along with standard 1:4 triangle refinement and a simple normalization projection.
Dutton later adopted a similar method to the regular octahedron~\cite{dutton1996encoding}.
While these two approaches are straightforward, they served as the groundwork for more sophisticated polyhedron-based DGGS's.
Some more recent examples include HEALPix~\cite{gorski2005healpix}, ISEA3H~\cite{sahr2003geodesic}, and One-to-Two Digital Earth~\cite{mahdavi2013one}.
We once again refer to~\cite{mahdavi2015survey} and~\cite{alderson2020digital} for a more detailed analysis and comparison of these different systems.


\subsection{3D Grids}
Same as regular grids but with altitude dimension.
Can be made from any of the above by extrusion method.
Lat-long -> 3D LLG -> GeoSOT3D.
Yin-yang -> 3D yin-yang.
Polyhedral -> frustum/prismatoid.
\cite{yoo2019concept}
\cite{sun20153d}
\cite{yoshida2004application}
\cite{kageyama2005geodynamo}
\cite{tackley2008modelling}


Issue of radial degeneration---see Chapter 3.something
Methods have been proposed that use method similar to igloo in radial dimension.
DQG -> SDOG.
SSS 3DG.
\cite{yu2009sdog}
\cite{yu2012large-scale}
\cite{yu2012lithosphere}
\cite{gang2013sphere} 
\cite{wang2013global}


\subsection{Grid Encoding and Decoding}
Need to map data/features to grid cells.
Most simple encoding is for points: find cell that contains point.
Inverse also needed: take cell and get geometry on reference model.
Call these encoding and decoding.
As part of this, need way to refer to cells uniquely.
\cite{du2018duality}


\subsubsection{Indexing Scheme} \label{sec::dggs:indexing}
For grid and cell geometries to be useful as a DGGS, a mechanism for assigning a unique index to each cell is needed.
Earth data is assigned to cells using these indices, which allows for efficient retrieval of all data associated with a specific cell or region of the Earth.
Thus, in order to be able to insert new data into the grid efficiently, it is important to be able to quickly determine the cell (and associated index) that contains a point on the Earth after it has been projected.
Likewise, given a cell index, it is important to be able to determine the geometry of the corresponding cell in the grid.
This geometry can then be inverse projected to find the region of the Earth associated with the cell.
These indices also allow for certain spatial relationship queries to be defined, such as the retrieval of neighbouring cells, and can be used to navigate up and down the hierarchy of the grid via parent and child relationships between cells in different resolutions.
\cite{yu2009coding}
\cite{vince2006indexing}
\cite{tong2013efficient}
\cite{mahdavi2015categorization}


\section{Summary}
Maps and globes have been around for thousands of years.
With advent of computer, GIS was born which carried over conventions of traditional cartography.
Recently, global grids have become popular as a replacement/augmentation of GIS.
Many different approached for DGG and DGGS.
3D DGGS are the next step of this evolution; techniques exist but still underdeveloped comparatively.
